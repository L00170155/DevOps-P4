name: ci + cd demo workflow

# define when the workflow should run/ On a push to main, a PR to main or manually with workflow

on:
  push:
    branches: [ march30 ]
  pull_request:
    branches: [ march30 ]
  workflow_dispatch: 
  
jobs:
  Install-linux:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v2
      with:
        node-version: '12'
    - run: | 
        npm install
        npm run-script build
        npm test -- -u

  sonarcloud:
    runs-on: ubuntu-latest
    needs: [Install-linux]
    environment:
      name: dev 
    steps:
    - uses: actions/checkout@v2
      with:
        # Disabling shallow clone is recommended for improving relevancy of reporting
        fetch-depth: 0
    - name: SonarCloud Scan
      uses: sonarsource/sonarcloud-github-action@master
      env:
        GITHUB_TOKEN: ${{ secrets.TOKEN_FOR_GITHUB }}
        SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}  

  Install-windows:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v2
      with:
        node-version: '14'
    - run: |
        npm install
        npm run-script build
        npm test -- -u
      

      
      